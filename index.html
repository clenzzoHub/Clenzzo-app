<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clenzzo - Premium Car Cleaning Service</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="manifest" href="data:application/json;base64,eyJuYW1lIjoiQ2xlbnp6byIsInNob3J0X25hbWUiOiJDbGVuenpvIiwic3RhcnRfdXJsIjoiLyIsImRpc3BsYXkiOiJzdGFuZGFsb25lIiwiYmFja2dyb3VuZF9jb2xvciI6IiNmZmZmZmYiLCJ0aGVtZV9jb2xvciI6IiMwMDk2ODgiLCJpY29ucyI6W3sic3JjIjoiZGF0YTppbWFnZS9zdmcreG1sO2Jhc2U2NCxQSE4yWnlCM2FXUjBhRDBpTWpRaUlHaGxhV2RvZEQwaU1qUWlJSFpwWlhkQ2IzZzlJakFnTUNBeU5DQXlOQ0lnWm1sc2JEMGlJekF3T1RZNE9DSStQR05wY21Oc1pTQmplRDBpTVRJaUlHTjVQU0l4TWlJZ2NqMGlPU0lnWm1sc2JEMGlJMlptWm1abUlpOCtQQzl6ZG1jKyIsInNpemVzIjoiMjR4MjQiLCJ0eXBlIjoiaW1hZ2Uvc3ZnK3htbCJ9XX0=">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Montserrat', sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 400px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
        }

        .card {
            background: white;
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }

        .logo {
            text-align: center;
            margin-bottom: 30px;
        }

        .logo h1 {
            color: #009688;
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .logo p {
            color: #666;
            font-size: 14px;
            font-weight: 400;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #333;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            font-family: 'Montserrat', sans-serif;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #009688;
        }

        .btn {
            width: 100%;
            padding: 14px;
            background: #009688;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            font-family: 'Montserrat', sans-serif;
            cursor: pointer;
            transition: background 0.3s ease;
            margin-bottom: 12px;
        }

        .btn:hover {
            background: #00796b;
        }

        .btn-secondary {
            background: #f5f5f5;
            color: #333;
        }

        .btn-secondary:hover {
            background: #e0e0e0;
        }

        .progress-bar {
            width: 100%;
            height: 6px;
            background: #e0e0e0;
            border-radius: 3px;
            margin-bottom: 24px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: #009688;
            transition: width 0.3s ease;
        }

        .step-indicator {
            text-align: center;
            margin-bottom: 20px;
            font-size: 14px;
            color: #666;
        }

        .welcome-card {
            text-align: center;
            background: linear-gradient(135deg, #009688 0%, #00796b 100%);
            color: white;
            margin-bottom: 24px;
        }

        .welcome-card h2 {
            font-size: 24px;
            margin-bottom: 8px;
        }

        .welcome-card p {
            opacity: 0.9;
        }

        .menu-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
            margin-bottom: 20px;
        }

        .menu-item {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            color: #333;
        }

        .menu-item:hover {
            border-color: #009688;
            transform: translateY(-2px);
            box-shadow: 0 4px 16px rgba(0, 150, 136, 0.2);
        }

        .menu-item .icon {
            font-size: 32px;
            margin-bottom: 8px;
        }

        .menu-item .title {
            font-weight: 600;
            margin-bottom: 4px;
        }

        .menu-item .subtitle {
            font-size: 12px;
            color: #666;
        }

        .plan-card {
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .plan-card.selected {
            border-color: #009688;
            background: #f0f9f8;
        }

        .plan-card .plan-title {
            font-weight: 600;
            font-size: 18px;
            margin-bottom: 8px;
        }

        .plan-card .plan-price {
            color: #009688;
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .plan-card .plan-desc {
            font-size: 14px;
            color: #666;
        }

        .error {
            color: #f44336;
            font-size: 14px;
            margin-top: 8px;
        }

        .success {
            color: #4caf50;
            font-size: 14px;
            margin-top: 8px;
        }

        .hidden {
            display: none;
        }

        .back-btn {
            background: #f5f5f5;
            color: #333;
            width: auto;
            padding: 8px 16px;
            margin-bottom: 20px;
            font-size: 14px;
        }

        .summary-item {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid #e0e0e0;
        }

        .summary-item:last-child {
            border-bottom: none;
            font-weight: 600;
            color: #009688;
        }

        .time-slots {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin-top: 12px;
        }

        .time-slot {
            padding: 8px;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            text-align: center;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .time-slot:hover {
            border-color: #009688;
        }

        .time-slot.selected {
            background: #009688;
            color: white;
            border-color: #009688;
        }

        .payment-options {
            display: grid;
            gap: 12px;
            margin-top: 12px;
        }

        .payment-option {
            padding: 16px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .payment-option:hover {
            border-color: #009688;
        }

        .payment-option.selected {
            border-color: #009688;
            background: #f0f9f8;
        }

        .loading {
            text-align: center;
            padding: 20px;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #e0e0e0;
            border-top: 4px solid #009688;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 16px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .profile-section {
            margin-bottom: 24px;
        }

        .profile-section h3 {
            color: #009688;
            margin-bottom: 16px;
            font-size: 18px;
        }

        .profile-item {
            background: #f9f9f9;
            padding: 16px;
            border-radius: 8px;
            margin-bottom: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .profile-item .label {
            font-weight: 500;
            color: #666;
            font-size: 14px;
        }

        .profile-item .value {
            font-weight: 600;
        }

        .add-btn {
            background: transparent;
            color: #009688;
            border: 2px solid #009688;
            padding: 12px;
            font-size: 14px;
        }

        .add-btn:hover {
            background: #009688;
            color: white;
        }

        @media (max-width: 480px) {
            .container {
                padding: 16px;
            }
            
            .menu-grid {
                grid-template-columns: 1fr;
            }
            
            .time-slots {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Login Screen -->
        <div id="loginScreen" class="screen">
            <div class="card">
                <div class="logo">
                    <h1>Clenzzo</h1>
                    <p>Premium Car Cleaning Service</p>
                </div>
                
                <form id="loginForm">
                    <div class="form-group">
                        <label for="loginPhone">Phone Number</label>
                        <input type="tel" id="loginPhone" placeholder="Enter 10-digit phone number" maxlength="10" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="loginPin">PIN</label>
                        <input type="password" id="loginPin" placeholder="Enter 4-digit PIN" maxlength="4" required>
                    </div>
                    
                    <button type="submit" class="btn">Login</button>
                    <button type="button" class="btn btn-secondary" onclick="showScreen('signupScreen')">Create Account</button>
                    
                    <div id="loginError" class="error hidden"></div>
                </form>
            </div>
        </div>

        <!-- Signup Screen -->
        <div id="signupScreen" class="screen hidden">
            <div class="card">
                <button class="btn back-btn" onclick="showScreen('loginScreen')">← Back to Login</button>
                
                <div class="progress-bar">
                    <div class="progress-fill" id="signupProgress" style="width: 12.5%"></div>
                </div>
                
                <div class="step-indicator">
                    <span id="signupStepText">Step 1 of 8</span>
                </div>
                
                <form id="signupForm">
                    <!-- Step 1: Name -->
                    <div class="signup-step" id="signupStep1">
                        <div class="form-group">
                            <label for="signupName">Full Name</label>
                            <input type="text" id="signupName" placeholder="Enter your full name" required>
                        </div>
                        <button type="button" class="btn" onclick="nextSignupStep()">Next</button>
                    </div>
                    
                    <!-- Step 2: Phone -->
                    <div class="signup-step hidden" id="signupStep2">
                        <div class="form-group">
                            <label for="signupPhone">Phone Number</label>
                            <input type="tel" id="signupPhone" placeholder="Enter 10-digit phone number" maxlength="10" required>
                        </div>
                        <button type="button" class="btn" onclick="nextSignupStep()">Next</button>
                    </div>
                    
                    <!-- Step 3: PIN -->
                    <div class="signup-step hidden" id="signupStep3">
                        <div class="form-group">
                            <label for="signupPin">Create PIN</label>
                            <input type="password" id="signupPin" placeholder="Enter 4-digit PIN" maxlength="4" required>
                        </div>
                        <div class="form-group">
                            <label for="confirmPin">Confirm PIN</label>
                            <input type="password" id="confirmPin" placeholder="Re-enter PIN" maxlength="4" required>
                        </div>
                        <button type="button" class="btn" onclick="nextSignupStep()">Next</button>
                    </div>
                    
                    <!-- Step 4: Address -->
                    <div class="signup-step hidden" id="signupStep4">
                        <div class="form-group">
                            <label for="signupPlot">Plot/House Number</label>
                            <input type="text" id="signupPlot" placeholder="Enter plot/house number" required>
                        </div>
                        <div class="form-group">
                            <label for="signupStreet">Street</label>
                            <input type="text" id="signupStreet" placeholder="Enter street name" required>
                        </div>
                        <div class="form-group">
                            <label for="signupArea">Area</label>
                            <input type="text" id="signupArea" placeholder="Enter area name" required>
                        </div>
                        <div class="form-group">
                            <label for="signupLandmark">Landmark</label>
                            <input type="text" id="signupLandmark" placeholder="Enter nearby landmark" required>
                        </div>
                        <div class="form-group">
                            <label for="signupPincode">Pincode</label>
                            <input type="text" id="signupPincode" placeholder="Enter pincode (62xxxx)" maxlength="6" required>
                        </div>
                        <button type="button" class="btn" onclick="nextSignupStep()">Next</button>
                    </div>
                    
                    <!-- Step 5: Car Type -->
                    <div class="signup-step hidden" id="signupStep5">
                        <div class="form-group">
                            <label for="signupCarType">Car Type</label>
                            <select id="signupCarType" required>
                                <option value="">Select car type</option>
                                <option value="Hatchback">Hatchback</option>
                                <option value="Sedan">Sedan</option>
                                <option value="SUV">SUV</option>
                                <option value="MPV">MPV</option>
                            </select>
                        </div>
                        <button type="button" class="btn" onclick="nextSignupStep()">Next</button>
                    </div>
                    
                    <!-- Step 6: Car Brand -->
                    <div class="signup-step hidden" id="signupStep6">
                        <div class="form-group">
                            <label for="signupCarBrand">Car Brand</label>
                            <select id="signupCarBrand" required>
                                <option value="">Select car brand</option>
                            </select>
                        </div>
                        <button type="button" class="btn" onclick="nextSignupStep()">Next</button>
                    </div>
                    
                    <!-- Step 7: Car Model -->
                    <div class="signup-step hidden" id="signupStep7">
                        <div class="form-group">
                            <label for="signupCarModel">Car Model</label>
                            <select id="signupCarModel" required>
                                <option value="">Select car model</option>
                            </select>
                        </div>
                        <button type="button" class="btn" onclick="nextSignupStep()">Next</button>
                    </div>
                    
                    <!-- Step 8: Car Plate -->
                    <div class="signup-step hidden" id="signupStep8">
                        <div class="form-group">
                            <label for="signupCarPlate">Car Plate Number</label>
                            <input type="text" id="signupCarPlate" placeholder="Enter car plate number" required>
                        </div>
                        <button type="button" class="btn" onclick="submitSignup()">Create Account</button>
                    </div>
                    
                    <div id="signupError" class="error hidden"></div>
                </form>
            </div>
        </div>

        <!-- Home Screen -->
        <div id="homeScreen" class="screen hidden">
            <div class="card welcome-card">
                <h2>Vanakkam Trichy!</h2>
                <p>Welcome to Clenzzo</p>
            </div>
            
            <div class="menu-grid">
                <div class="menu-item" onclick="showScreen('trialBookingScreen')">
                    <div class="icon">🆓</div>
                    <div class="title">Trial Booking</div>
                    <div class="subtitle">Free service</div>
                </div>
                
                <div class="menu-item" onclick="showScreen('oneTimeBookingScreen')">
                    <div class="icon">🚗</div>
                    <div class="title">Book Us</div>
                    <div class="subtitle">One-time service</div>
                </div>
                
                <div class="menu-item" onclick="showScreen('subscriptionScreen')">
                    <div class="icon">📅</div>
                    <div class="title">Subscribe Us</div>
                    <div class="subtitle">Monthly plans</div>
                </div>
                
                <div class="menu-item" onclick="showScreen('profileScreen')">
                    <div class="icon">👤</div>
                    <div class="title">Profile</div>
                    <div class="subtitle">Manage account</div>
                </div>
            </div>
            
            <button class="btn btn-secondary" onclick="logout()">Logout</button>
        </div>

        <!-- Trial Booking Screen -->
        <div id="trialBookingScreen" class="screen hidden">
            <div class="card">
                <button class="btn back-btn" onclick="showScreen('homeScreen')">← Back to Home</button>
                
                <div class="progress-bar">
                    <div class="progress-fill" id="trialProgress" style="width: 16.67%"></div>
                </div>
                
                <div class="step-indicator">
                    <span id="trialStepText">Step 1 of 6</span>
                </div>
                
                <form id="trialForm">
                    <!-- Step 1: Name -->
                    <div class="trial-step" id="trialStep1">
                        <div class="form-group">
                            <label for="trialName">Full Name</label>
                            <input type="text" id="trialName" placeholder="Enter your full name" required>
                        </div>
                        <button type="button" class="btn" onclick="nextTrialStep()">Next</button>
                    </div>
                    
                    <!-- Step 2: Address -->
                    <div class="trial-step hidden" id="trialStep2">
                        <div class="form-group">
                            <label for="trialAddress">Complete Address</label>
                            <textarea id="trialAddress" rows="4" placeholder="Enter your complete address in Trichy" required></textarea>
                        </div>
                        <button type="button" class="btn" onclick="nextTrialStep()">Next</button>
                    </div>
                    
                    <!-- Step 3: Car Type -->
                    <div class="trial-step hidden" id="trialStep3">
                        <div class="form-group">
                            <label for="trialCarType">Car Type</label>
                            <select id="trialCarType" required>
                                <option value="">Select car type</option>
                                <option value="Hatchback">Hatchback</option>
                                <option value="Sedan">Sedan</option>
                                <option value="SUV">SUV</option>
                                <option value="MPV">MPV</option>
                            </select>
                        </div>
                        <button type="button" class="btn" onclick="nextTrialStep()">Next</button>
                    </div>
                    
                    <!-- Step 4: Car Brand -->
                    <div class="trial-step hidden" id="trialStep4">
                        <div class="form-group">
                            <label for="trialCarBrand">Car Brand</label>
                            <select id="trialCarBrand" required>
                                <option value="">Select car brand</option>
                            </select>
                        </div>
                        <button type="button" class="btn" onclick="nextTrialStep()">Next</button>
                    </div>
                    
                    <!-- Step 5: Car Model -->
                    <div class="trial-step hidden" id="trialStep5">
                        <div class="form-group">
                            <label for="trialCarModel">Car Model</label>
                            <select id="trialCarModel" required>
                                <option value="">Select car model</option>
                            </select>
                        </div>
                        <button type="button" class="btn" onclick="nextTrialStep()">Next</button>
                    </div>
                    
                    <!-- Step 6: Date & Time -->
                    <div class="trial-step hidden" id="trialStep6">
                        <div class="form-group">
                            <label for="trialDate">Preferred Date</label>
                            <input type="date" id="trialDate" required>
                        </div>
                        
                        <div class="form-group">
                            <label>Preferred Time</label>
                            <div class="time-slots" id="trialTimeSlots"></div>
                        </div>
                        
                        <button type="button" class="btn" onclick="submitTrial()">Confirm Trial Booking</button>
                    </div>
                    
                    <div id="trialError" class="error hidden"></div>
                </form>
            </div>
        </div>

        <!-- One-Time Booking Screen -->
        <div id="oneTimeBookingScreen" class="screen hidden">
            <div class="card">
                <button class="btn back-btn" onclick="showScreen('homeScreen')">← Back to Home</button>
                
                <div class="progress-bar">
                    <div class="progress-fill" id="bookingProgress" style="width: 10%"></div>
                </div>
                
                <div class="step-indicator">
                    <span id="bookingStepText">Step 1 of 10</span>
                </div>
                
                <form id="bookingForm">
                    <!-- Steps 1-10 similar to trial but with additional fields -->
                    <div class="booking-step" id="bookingStep1">
                        <div class="form-group">
                            <label for="bookingName">Full Name</label>
                            <input type="text" id="bookingName" placeholder="Enter your full name" required>
                        </div>
                        <button type="button" class="btn" onclick="nextBookingStep()">Next</button>
                    </div>
                    
                    <!-- Additional steps would be implemented similarly -->
                    <div id="bookingError" class="error hidden"></div>
                </form>
            </div>
        </div>

        <!-- Subscription Screen -->
        <div id="subscriptionScreen" class="screen hidden">
            <div class="card">
                <button class="btn back-btn" onclick="showScreen('homeScreen')">← Back to Home</button>
                
                <div class="progress-bar">
                    <div class="progress-fill" id="subscriptionProgress" style="width: 9.09%"></div>
                </div>
                
                <div class="step-indicator">
                    <span id="subscriptionStepText">Step 1 of 11</span>
                </div>
                
                <form id="subscriptionForm">
                    <!-- Step 1: Name -->
                    <div class="subscription-step" id="subscriptionStep1">
                        <div class="form-group">
                            <label for="subscriptionName">Full Name</label>
                            <input type="text" id="subscriptionName" placeholder="Enter your full name" required>
                        </div>
                        <button type="button" class="btn" onclick="nextSubscriptionStep()">Next</button>
                    </div>
                    
                    <!-- Step 5: Choose Plan -->
                    <div class="subscription-step hidden" id="subscriptionStep5">
                        <h3 style="margin-bottom: 20px; color: #009688;">Choose Your Plan</h3>
                        
                        <div class="plan-card" onclick="selectPlan('1month', 1200)">
                            <div class="plan-title">1 Month Plan</div>
                            <div class="plan-price">₹1,200</div>
                            <div class="plan-desc">Perfect for trying our service</div>
                        </div>
                        
                        <div class="plan-card" onclick="selectPlan('3months', 3600)">
                            <div class="plan-title">3 Months Plan</div>
                            <div class="plan-price">₹3,600</div>
                            <div class="plan-desc">Great value for regular users</div>
                        </div>
                        
                        <div class="plan-card" onclick="selectPlan('6months', 7200)">
                            <div class="plan-title">6 Months Plan</div>
                            <div class="plan-price">₹7,200</div>
                            <div class="plan-desc">Best value for committed users</div>
                        </div>
                        
                        <div class="plan-card" onclick="selectPlan('12months', 14400)">
                            <div class="plan-title">12 Months Plan</div>
                            <div class="plan-price">₹14,400</div>
                            <div class="plan-desc">Ultimate savings for loyal customers</div>
                        </div>
                        
                        <button type="button" class="btn" onclick="nextSubscriptionStep()">Next</button>
                    </div>
                    
                    <div id="subscriptionError" class="error hidden"></div>
                </form>
            </div>
        </div>

        <!-- Profile Screen -->
        <div id="profileScreen" class="screen hidden">
            <div class="card">
                <button class="btn back-btn" onclick="showScreen('homeScreen')">← Back to Home</button>
                
                <div class="profile-section">
                    <h3>Personal Information</h3>
                    <div class="profile-item">
                        <div>
                            <div class="label">Name</div>
                            <div class="value" id="profileName">-</div>
                        </div>
                    </div>
                    <div class="profile-item">
                        <div>
                            <div class="label">Phone</div>
                            <div class="value" id="profilePhone">-</div>
                        </div>
                    </div>
                </div>
                
                <div class="profile-section">
                    <h3>Addresses</h3>
                    <div id="profileAddresses"></div>
                    <button class="btn add-btn" onclick="showAddAddress()">+ Add New Address</button>
                </div>
                
                <div class="profile-section">
                    <h3>Cars</h3>
                    <div id="profileCars"></div>
                    <button class="btn add-btn" onclick="showAddCar()">+ Add New Car</button>
                </div>
            </div>
        </div>

        <!-- Loading Screen -->
        <div id="loadingScreen" class="screen hidden">
            <div class="card">
                <div class="loading">
                    <div class="spinner"></div>
                    <p>Processing your request...</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Car data
        const carData = {
            "Hatchback": {
                "Maruti Suzuki": ["Swift", "Wagon R", "Alto", "Celerio", "Baleno", "Ignis"],
                "Hyundai": ["i10", "i20", "Grand i10", "Santro"],
                "Tata": ["Tiago", "Altroz", "Punch"],
                "Honda": ["Jazz", "Brio"],
                "Nissan": ["Micra"],
                "Ford": ["Figo"],
                "Renault": ["Kwid"]
            },
            "Sedan": {
                "Maruti Suzuki": ["Dzire", "Ciaz"],
                "Honda": ["City", "Amaze"],
                "Hyundai": ["Verna", "Aura", "Xcent"],
                "Tata": ["Tigor", "Zest"],
                "Volkswagen": ["Vento", "Polo"],
                "Skoda": ["Rapid"],
                "Toyota": ["Yaris", "Etios"],
                "Nissan": ["Sunny"]
            },
            "SUV": {
                "Hyundai": ["Creta", "Venue", "Tucson", "Santa Fe"],
                "Tata": ["Nexon", "Harrier", "Safari", "Hexa"],
                "Maruti Suzuki": ["Vitara Brezza", "S-Cross", "XL6"],
                "Mahindra": ["XUV300", "XUV500", "XUV700", "Scorpio", "Thar", "Bolero"],
                "Kia": ["Seltos", "Sonet", "Carnival"],
                "MG": ["Hector", "ZS EV", "Astor"],
                "Toyota": ["Fortuner", "Urban Cruiser"],
                "Ford": ["EcoSport", "Endeavour"],
                "Renault": ["Duster", "Captur"],
                "Nissan": ["Terrano", "Kicks"]
            },
            "MPV": {
                "Toyota": ["Innova Crysta", "Rumion"],
                "Maruti Suzuki": ["Ertiga", "Eeco"],
                "Mahindra": ["Marazzo", "Xylo"],
                "Renault": ["Triber"],
                "Datsun": ["GO+"]
            }
        };

        // Global variables
        let currentUser = null;
        let currentStep = 1;
        let selectedPlan = null;
        let selectedTime = null;

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            checkSession();
            setupDateConstraints();
            generateTimeSlots();
        });

        // Session management
        function checkSession() {
            const savedUser = localStorage.getItem('clenzzo_user');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                showScreen('homeScreen');
                loadProfile();
            } else {
                showScreen('loginScreen');
            }
        }

        function logout() {
            localStorage.removeItem('clenzzo_user');
            currentUser = null;
            showScreen('loginScreen');
        }

        // Screen management
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.add('hidden');
            });
            document.getElementById(screenId).classList.remove('hidden');
        }

        // Login functionality
        document.getElementById('loginForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const phone = document.getElementById('loginPhone').value;
            const pin = document.getElementById('loginPin').value;
            
            if (!validatePhone(phone)) {
                showError('loginError', 'Please enter a valid 10-digit phone number');
                return;
            }
            
            if (!validatePin(pin)) {
                showError('loginError', 'Please enter a valid 4-digit PIN');
                return;
            }
            
            showScreen('loadingScreen');
            
            try {
                const response = await fetch('https://script.google.com/macros/s/AKfycbx39YdQXdd8lUj83dgfyJXjpSJL8W8OnLX_le6WKcTZ3UTYrsZJRwQaKG4c5awitA0/exec', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                    },
                    body: `action=checkUser&phone=${phone}&pin=${pin}`
                });
                
                const result = await response.json();
                
                if (result.success) {
                    currentUser = result.user;
                    localStorage.setItem('clenzzo_user', JSON.stringify(currentUser));
                    showScreen('homeScreen');
                    loadProfile();
                } else {
                    showScreen('loginScreen');
                    showError('loginError', result.message || 'Invalid phone number or PIN');
                }
            } catch (error) {
                showScreen('loginScreen');
                showError('loginError', 'Connection error. Please try again.');
            }
        });

        // Signup functionality
        let signupData = {};
        let signupCurrentStep = 1;

        function nextSignupStep() {
            const currentStepData = validateSignupStep(signupCurrentStep);
            if (!currentStepData) return;
            
            Object.assign(signupData, currentStepData);
            
            if (signupCurrentStep < 8) {
                document.getElementById(`signupStep${signupCurrentStep}`).classList.add('hidden');
                signupCurrentStep++;
                document.getElementById(`signupStep${signupCurrentStep}`).classList.remove('hidden');
                
                updateSignupProgress();
                
                // Handle car type selection
                if (signupCurrentStep === 6) {
                    populateCarBrands('signupCarBrand', signupData.carType);
                } else if (signupCurrentStep === 7) {
                    populateCarModels('signupCarModel', signupData.carType, signupData.carBrand);
                }
            }
        }

        function validateSignupStep(step) {
            const errorElement = document.getElementById('signupError');
            errorElement.classList.add('hidden');
            
            switch(step) {
                case 1:
                    const name = document.getElementById('signupName').value.trim();
                    if (!validateName(name)) {
                        showError('signupError', 'Please enter a valid name (alphabets only)');
                        return null;
                    }
                    return { name };
                    
                case 2:
                    const phone = document.getElementById('signupPhone').value;
                    if (!validatePhone(phone)) {
                        showError('signupError', 'Please enter a valid 10-digit phone number');
                        return null;
                    }
                    return { phone };
                    
                case 3:
                    const pin = document.getElementById('signupPin').value;
                    const confirmPin = document.getElementById('confirmPin').value;
                    if (!validatePin(pin)) {
                        showError('signupError', 'Please enter a valid 4-digit PIN');
                        return null;
                    }
                    if (pin !== confirmPin) {
                        showError('signupError', 'PINs do not match');
                        return null;
                    }
                    return { pin };
                    
                case 4:
                    const plot = document.getElementById('signupPlot').value.trim();
                    const street = document.getElementById('signupStreet').value.trim();
                    const area = document.getElementById('signupArea').value.trim();
                    const landmark = document.getElementById('signupLandmark').value.trim();
                    const pincode = document.getElementById('signupPincode').value;
                    
                    if (!plot || !street || !area || !landmark) {
                        showError('signupError', 'Please fill all address fields');
                        return null;
                    }
                    if (!validatePincode(pincode)) {
                        showError('signupError', 'Please enter a valid Trichy pincode (62xxxx)');
                        return null;
                    }
                    return { plot, street, area, landmark, pincode, city: 'Trichy' };
                    
                case 5:
                    const carType = document.getElementById('signupCarType').value;
                    if (!carType) {
                        showError('signupError', 'Please select a car type');
                        return null;
                    }
                    return { carType };
                    
                case 6:
                    const carBrand = document.getElementById('signupCarBrand').value;
                    if (!carBrand) {
                        showError('signupError', 'Please select a car brand');
                        return null;
                    }
                    return { carBrand };
                    
                case 7:
                    const carModel = document.getElementById('signupCarModel').value;
                    if (!carModel) {
                        showError('signupError', 'Please select a car model');
                        return null;
                    }
                    return { carModel };
            }
            return null;
        }

        function updateSignupProgress() {
            const progress = (signupCurrentStep / 8) * 100;
            document.getElementById('signupProgress').style.width = progress + '%';
            document.getElementById('signupStepText').textContent = `Step ${signupCurrentStep} of 8`;
        }

        async function submitSignup() {
            const carPlate = document.getElementById('signupCarPlate').value.trim();
            if (!carPlate) {
                showError('signupError', 'Please enter car plate number');
                return;
            }
            
            signupData.carPlate = carPlate;
            
            showScreen('loadingScreen');
            
            try {
                const response = await fetch('https://script.google.com/macros/s/AKfycbx39YdQXdd8lUj83dgfyJXjpSJL8W8OnLX_le6WKcTZ3UTYrsZJRwQaKG4c5awitA0/exec', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        action: 'registerUser',
                        ...signupData
                    })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    showScreen('loginScreen');
                    showSuccess('loginError', 'Account created successfully! Please login.');
                } else {
                    showScreen('signupScreen');
                    showError('signupError', result.message || 'Registration failed');
                }
            } catch (error) {
                showScreen('signupScreen');
                showError('signupError', 'Connection error. Please try again.');
            }
        }

        // Trial booking functionality
        let trialData = {};
        let trialCurrentStep = 1;

        function nextTrialStep() {
            const currentStepData = validateTrialStep(trialCurrentStep);
            if (!currentStepData) return;
            
            Object.assign(trialData, currentStepData);
            
            if (trialCurrentStep < 6) {
                document.getElementById(`trialStep${trialCurrentStep}`).classList.add('hidden');
                trialCurrentStep++;
                document.getElementById(`trialStep${trialCurrentStep}`).classList.remove('hidden');
                
                updateTrialProgress();
                
                // Handle car type selection
                if (trialCurrentStep === 4) {
                    populateCarBrands('trialCarBrand', trialData.carType);
                } else if (trialCurrentStep === 5) {
                    populateCarModels('trialCarModel', trialData.carType, trialData.carBrand);
                }
            }
        }

        function validateTrialStep(step) {
            const errorElement = document.getElementById('trialError');
            errorElement.classList.add('hidden');
            
            switch(step) {
                case 1:
                    const name = document.getElementById('trialName').value.trim();
                    if (!validateName(name)) {
                        showError('trialError', 'Please enter a valid name');
                        return null;
                    }
                    return { name };
                    
                case 2:
                    const address = document.getElementById('trialAddress').value.trim();
                    if (!address) {
                        showError('trialError', 'Please enter your address');
                        return null;
                    }
                    return { address };
                    
                case 3:
                    const carType = document.getElementById('trialCarType').value;
                    if (!carType) {
                        showError('trialError', 'Please select a car type');
                        return null;
                    }
                    return { carType };
                    
                case 4:
                    const carBrand = document.getElementById('trialCarBrand').value;
                    if (!carBrand) {
                        showError('trialError', 'Please select a car brand');
                        return null;
                    }
                    return { carBrand };
                    
                case 5:
                    const carModel = document.getElementById('trialCarModel').value;
                    if (!carModel) {
                        showError('trialError', 'Please select a car model');
                        return null;
                    }
                    return { carModel };
            }
            return null;
        }

        function updateTrialProgress() {
            const progress = (trialCurrentStep / 6) * 100;
            document.getElementById('trialProgress').style.width = progress + '%';
            document.getElementById('trialStepText').textContent = `Step ${trialCurrentStep} of 6`;
        }

        async function submitTrial() {
            const date = document.getElementById('trialDate').value;
            if (!date) {
                showError('trialError', 'Please select a date');
                return;
            }
            
            if (!selectedTime) {
                showError('trialError', 'Please select a time slot');
                return;
            }
            
            trialData.date = date;
            trialData.time = selectedTime;
            
            showScreen('loadingScreen');
            
            try {
                const response = await fetch('https://script.google.com/macros/s/AKfycbx39YdQXdd8lUj83dgfyJXjpSJL8W8OnLX_le6WKcTZ3UTYrsZJRwQaKG4c5awitA0/exec', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        action: 'submitBooking',
                        type: 'trial',
                        ...trialData
                    })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    const message = `Hi! I've booked a FREE trial car cleaning service through Clenzzo app.%0A%0ADetails:%0AName: ${trialData.name}%0AAddress: ${trialData.address}%0ACar: ${trialData.carBrand} ${trialData.carModel} (${trialData.carType})%0ADate: ${trialData.date}%0ATime: ${trialData.time}%0A%0APlease confirm my booking. Thank you!`;
                    window.open(`https://wa.me/918122213141?text=${message}`, '_blank');
                    showScreen('homeScreen');
                } else {
                    showScreen('trialBookingScreen');
                    showError('trialError', result.message || 'Booking failed');
                }
            } catch (error) {
                showScreen('trialBookingScreen');
                showError('trialError', 'Connection error. Please try again.');
            }
        }

        // Car data population
        function populateCarBrands(selectId, carType) {
            const select = document.getElementById(selectId);
            select.innerHTML = '<option value="">Select car brand</option>';
            
            if (carData[carType]) {
                Object.keys(carData[carType]).forEach(brand => {
                    const option = document.createElement('option');
                    option.value = brand;
                    option.textContent = brand;
                    select.appendChild(option);
                });
            }
        }

        function populateCarModels(selectId, carType, carBrand) {
            const select = document.getElementById(selectId);
            select.innerHTML = '<option value="">Select car model</option>';
            
            if (carData[carType] && carData[carType][carBrand]) {
                carData[carType][carBrand].forEach(model => {
                    const option = document.createElement('option');
                    option.value = model;
                    option.textContent = model;
                    select.appendChild(option);
                });
            }
        }

        // Car type change handlers
        document.getElementById('signupCarType').addEventListener('change', function() {
            populateCarBrands('signupCarBrand', this.value);
            document.getElementById('signupCarModel').innerHTML = '<option value="">Select car model</option>';
        });

        document.getElementById('signupCarBrand').addEventListener('change', function() {
            const carType = document.getElementById('signupCarType').value;
            populateCarModels('signupCarModel', carType, this.value);
        });

        document.getElementById('trialCarType').addEventListener('change', function() {
            populateCarBrands('trialCarBrand', this.value);
            document.getElementById('trialCarModel').innerHTML = '<option value="">Select car model</option>';
        });

        document.getElementById('trialCarBrand').addEventListener('change', function() {
            const carType = document.getElementById('trialCarType').value;
            populateCarModels('trialCarModel', carType, this.value);
        });

        // Date constraints
        function setupDateConstraints() {
            const today = new Date();
            const october1 = new Date(today.getFullYear(), 9, 1); // October 1st
            
            // If current date is before October 1st, set min date to October 1st
            const minDate = today < october1 ? october1 : today;
            
            const dateInputs = ['trialDate'];
            dateInputs.forEach(inputId => {
                const input = document.getElementById(inputId);
                if (input) {
                    input.min = minDate.toISOString().split('T')[0];
                }
            });
        }

        // Time slots generation
        function generateTimeSlots() {
            const container = document.getElementById('trialTimeSlots');
            if (!container) return;
            
            container.innerHTML = '';
            
            // Generate slots from 7 AM to 7 PM (half-hour intervals)
            for (let hour = 7; hour <= 19; hour++) {
                for (let minute = 0; minute < 60; minute += 30) {
                    if (hour === 19 && minute > 0) break; // Stop at 7 PM
                    
                    const timeString = `${hour.toString().padStart(2, '0')}:${minute.toString().padStart(2, '0')}`;
                    const displayTime = formatTime(hour, minute);
                    
                    const slot = document.createElement('div');
                    slot.className = 'time-slot';
                    slot.textContent = displayTime;
                    slot.onclick = () => selectTimeSlot(slot, timeString);
                    
                    container.appendChild(slot);
                }
            }
        }

        function formatTime(hour, minute) {
            const period = hour >= 12 ? 'PM' : 'AM';
            const displayHour = hour > 12 ? hour - 12 : (hour === 0 ? 12 : hour);
            return `${displayHour}:${minute.toString().padStart(2, '0')} ${period}`;
        }

        function selectTimeSlot(element, time) {
            document.querySelectorAll('.time-slot').forEach(slot => {
                slot.classList.remove('selected');
            });
            element.classList.add('selected');
            selectedTime = time;
        }

        // Plan selection
        function selectPlan(planType, price) {
            document.querySelectorAll('.plan-card').forEach(card => {
                card.classList.remove('selected');
            });
            event.target.closest('.plan-card').classList.add('selected');
            selectedPlan = { type: planType, price: price };
        }

        // Profile management
        function loadProfile() {
            if (!currentUser) return;
            
            document.getElementById('profileName').textContent = currentUser.name || '-';
            document.getElementById('profilePhone').textContent = currentUser.phone || '-';
            
            // Load addresses and cars (would be fetched from backend)
            // This is a placeholder implementation
        }

        // Validation functions
        function validateName(name) {
            return /^[a-zA-Z\s]+$/.test(name) && name.length > 0;
        }

        function validatePhone(phone) {
            return /^[6-9]\d{9}$/.test(phone);
        }

        function validatePin(pin) {
            return /^\d{4}$/.test(pin);
        }

        function validatePincode(pincode) {
            return /^62\d{4}$/.test(pincode);
        }

        // Utility functions
        function showError(elementId, message) {
            const element = document.getElementById(elementId);
            element.textContent = message;
            element.classList.remove('hidden', 'success');
            element.classList.add('error');
        }

        function showSuccess(elementId, message) {
            const element = document.getElementById(elementId);
            element.textContent = message;
            element.classList.remove('hidden', 'error');
            element.classList.add('success');
        }

        // Placeholder functions for additional features
        function nextBookingStep() {
            // Implementation for one-time booking steps
        }

        function nextSubscriptionStep() {
            // Implementation for subscription steps
        }

        function showAddAddress() {
            // Implementation for adding new address
        }

        function showAddCar() {
            // Implementation for adding new car
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97e22095e7ed7fdb',t:'MTc1NzcwODY1NS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
